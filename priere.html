<!DOCTYPE html>
<!-- saved from url=(0079)https://ansaralmouyassar.github.io/pr-visualisez-l-application-beta/priere.html -->
<html lang="fr" dir="rtl"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heures de Prière - Muslim Time</title>
    <link rel="stylesheet" href="./all.min.css">
    <style>
        :root {
            --primary: #073332;       /* Nouveau vert foncé */
            --secondary: #0A4D44;      /* Vert émeraude foncé */
            --accent: #05C7A0;         /* Turquoise vif */
            --light-accent: #7FD8C6;    /* Turquoise clair */
            --text: #E0F2F0;           /* Texte clair */
            --light-text: #FFFFFF;     /* Blanc pur */
            --dark-text: #02201F;      /* Texte foncé */
            --card-bg: rgba(10, 77, 68, 0.4); /* Fond des cartes */
            --active-color: #05C7A0;    /* Couleur pour éléments actifs */
            --active-bg: rgba(5, 199, 160, 0.2);
            --prayer-icon-bg: rgba(255, 255, 255, 0.15);
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--primary);
            color: var(--text);
            line-height: 1.6;
            background-image: url('https://images.unsplash.com/photo-1542816417-0983675acc57?ixlib=rb-1.2.1&auto=format&fit=crop&w=1480&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(7, 51, 50, 0.85);  /* Couche semi-transparente plus foncée */
            z-index: -1;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 15px;
        }

        header {
            text-align: center;
            padding: 15px 0;
            margin-bottom: 20px;
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--light-text);
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }

        header p {
            font-size: 0.9rem;
            opacity: 0.9;
            color: var(--light-accent);
        }

        .location-bar {
            background-color: var(--card-bg);
            color: var(--light-text);
            border-radius: 10px;
            padding: 10px 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .location-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .location-info i {
            color: var(--accent);
        }

        .weather-info {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .time-date-bar {
            background-color: var(--secondary);
            color: var(--light-text);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .time-display {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .date-display {
            text-align: left;
            font-size: 0.9rem;
        }

        .hijri-date {
            font-weight: 600;
            color: var(--light-accent);
        }

        .next-prayer {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .next-prayer h2 {
            color: var(--light-text);
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .next-prayer h2 i {
            margin-left: 8px;
            color: var(--accent);
        }

        .next-prayer-content {
            padding: 10px 0;
        }

        .next-prayer-name {
            font-size: 1.3rem;
            color: var(--accent);
            font-weight: 700;
            margin-bottom: 5px;
        }

        .next-prayer-time {
            font-size: 2rem;
            font-weight: 700;
            color: var(--light-text);
            margin-bottom: 10px;
        }

        .countdown {
            font-size: 1.1rem;
            color: var(--light-accent);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .progress-container {
            width: 100%;
            height: 6px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--light-accent));
            width: 0%;
            transition: width 0.5s linear;
        }

        .prayer-times {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .prayer-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            color: var(--light-text);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
        }

        .prayer-card.active {
            background-color: var(--active-bg);
            border-right: 4px solid var(--active-color);
            transform: translateY(-2px);
        }

        .prayer-info {
            display: flex;
            align-items: center;
        }

        .prayer-icon {
            width: 40px;
            height: 40px;
            background-color: var(--prayer-icon-bg);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-left: 12px;
            color: var(--light-text);
            font-size: 1.1rem;
        }

        .prayer-name {
            font-weight: 600;
            color: var(--light-text);
            margin-bottom: 3px;
        }

        .prayer-remaining {
            font-size: 0.8rem;
            color: var(--light-accent);
        }

        .prayer-time {
            text-align: left;
        }

        .prayer-time-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--light-text);
        }

        .prayer-time-remaining {
            font-size: 0.8rem;
            color: var(--light-accent);
            text-align: left;
        }

        footer {
            text-align: center;
            padding: 15px;
            color: var(--light-accent);
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* Modal pour la demande de localisation */
        .location-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: var(--secondary);
            padding: 25px;
            border-radius: 15px;
            max-width: 90%;
            width: 400px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
        }

        .modal-content h2 {
            color: var(--light-text);
            margin-bottom: 15px;
        }

        .modal-content p {
            color: var(--light-accent);
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-allow {
            background-color: var(--accent);
            color: var(--dark-text);
        }

        .btn-deny {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--light-text);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* Media Queries pour les écrans plus larges */
        @media (min-width: 768px) {
            .prayer-times {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 992px) {
            .container {
                max-width: 800px;
            }
            
            .prayer-times {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Modal de demande de localisation -->
    <div class="location-modal" id="location-modal" style="display: flex;">
        <div class="modal-content">
            <h2><i class="fas fa-map-marker-alt"></i> Autorisation de localisation</h2>
            <p>Pour afficher les heures de prière précises pour votre position, nous avons besoin de votre autorisation pour accéder à votre localisation.</p>
            <div class="modal-buttons">
                <button class="modal-btn btn-allow" id="allow-location">
                    <i class="fas fa-check"></i> Autoriser
                </button>
                <button class="modal-btn btn-deny" id="deny-location">
                    <i class="fas fa-times"></i> Refuser
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
                      <h1></h1>

            <h1><i class="fas fa-mosque"></i> Heures de prières</h1>
            <p>إِنَّ الصَّلَاةَ كَانَتْ عَلَى الْمُؤْمِنِينَ كِتَابًا مَّوْقُوتًا</p>
        </header>

        <div class="location-bar">
            <div class="location-info">
                <i class="fas fa-map-marker-alt"></i>
                <span id="city">Chargement...</span>, <span id="country">Chargement...</span>
            </div>
            <div class="weather-info">
                <i class="fas fa-temperature-high"></i>
                <span id="temperature">--°C</span>
            </div>
        </div>

        <div class="time-date-bar">
    <div class="time-display" id="current-time">16:50:14</div>
    <div class="date-display">
        <div id="gregorian-date">mer. 13 août 2025</div>
        <div class="hijri-date" id="hijri-date">--/--/---- AH</div>
    </div>
</div>

        <div class="next-prayer">
            <h2><i class="fas fa-bell"></i> Prochaine Prière</h2>
            <div class="next-prayer-content">
                <div class="next-prayer-name" id="next-prayer-name">Chargement...</div>
                <div class="next-prayer-time" id="next-prayer-time">--:--</div>
                <div class="countdown" id="countdown">--:--:--</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
            </div>
        </div>

        <div class="prayer-times" id="prayer-times-container">
            <!-- Les cartes de prière seront ajoutées dynamiquement -->
        </div>

        <footer>
            <p>ANSAR</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Configuration
            const prayerNames = {
                Fajr: { name: 'Fajr', icon: 'fa-sun', color: '#7FD8C6' },
                Dhuhr: { name: 'Dhuhr', icon: 'fa-sun', color: '#05C7A0' },
                Asr: { name: 'Asr', icon: 'fa-sun', color: '#0A9D7F' },
                Maghrib: { name: 'Maghrib', icon: 'fa-moon', color: '#E0F2F0' },
                Isha: { name: 'Isha', icon: 'fa-moon', color: '#FFFFFF' }
            };

            // Éléments du DOM
            const currentTimeElement = document.getElementById('current-time');
            const gregorianDateElement = document.getElementById('gregorian-date');
            const nextPrayerNameElement = document.getElementById('next-prayer-name');
            const nextPrayerTimeElement = document.getElementById('next-prayer-time');
            const countdownElement = document.getElementById('countdown');
            const progressBarElement = document.getElementById('progress-bar');
            const cityElement = document.getElementById('city');
            const countryElement = document.getElementById('country');
            const temperatureElement = document.getElementById('temperature');
            const prayerTimesContainer = document.getElementById('prayer-times-container');
            const locationModal = document.getElementById('location-modal');
            const allowLocationBtn = document.getElementById('allow-location');
            const denyLocationBtn = document.getElementById('deny-location');

            // Variables d'état
            let prayerTimes = {};
            let currentLocation = {};
            let nextPrayer = null;
            let countdownInterval = null;
            let currentTimeInterval = null;
            let userRespondedToLocation = false;

            // Afficher la modal de localisation au chargement
            showLocationModal();

            // Initialisation
            updateCurrentTimeAndDate();
            currentTimeInterval = setInterval(updateCurrentTimeAndDate, 1000);
            
            // Écouteurs d'événements pour la modal
            allowLocationBtn.addEventListener('click', function() {
                hideLocationModal();
                getUserLocation();
            });

            denyLocationBtn.addEventListener('click', function() {
                hideLocationModal();
                // Utiliser des coordonnées par défaut (La Mecque)
                useDefaultLocation();
            });

            function showLocationModal() {
                locationModal.style.display = 'flex';
            }

            function hideLocationModal() {
                locationModal.style.display = 'none';
                userRespondedToLocation = true;
            }

            async function getUserLocation() {
                try {
                    const position = await getCurrentPosition();
                    await Promise.all([
                        getLocationInfo(position.coords.latitude, position.coords.longitude),
                        getWeather(position.coords.latitude, position.coords.longitude),
                        getPrayerTimes(position.coords.latitude, position.coords.longitude),
                        getHijriDate()
                    ]);
                } catch (error) {
                    console.error("Erreur de localisation:", error);
                    useDefaultLocation();
                }
            }

            function useDefaultLocation() {
                // Coordonnées par défaut (La Mecque)
                const meccaLat = 21.3891;
                const meccaLng = 39.8579;
                
                // Mettre à jour l'interface pour indiquer la localisation par défaut
                cityElement.textContent = "La Mecque";
                countryElement.textContent = "Arabie Saoudite";
                
                Promise.all([
                    getWeather(meccaLat, meccaLng),
                    getPrayerTimes(meccaLat, meccaLng),
                    getHijriDate()
                ]);
            }

            function getCurrentPosition() {
                return new Promise((resolve, reject) => {
                    if (navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(
                            resolve, 
                            reject,
                            { enableHighAccuracy: true, timeout: 10000 }
                        );
                    } else {
                        reject(new Error("La géolocalisation n'est pas supportée"));
                    }
                });
            }

            function updateCurrentTimeAndDate() {
    const now = new Date();
    
    // Mettre à jour l'heure
    const timeString = now.toLocaleTimeString('fr-FR', { 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit' 
    });
    currentTimeElement.textContent = timeString;
    
    // Mettre à jour la date grégorienne
    const options = { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' };
    gregorianDateElement.textContent = now.toLocaleDateString('fr-FR', options);
    
    // Rafraîchir la date hijri à minuit
    if (now.getHours() === 0 && now.getMinutes() === 0 && now.getSeconds() === 0) {
        getHijriDate();
    }
    
    if (Object.keys(prayerTimes).length > 0) {
        updateNextPrayer();
    }
}

            async function getLocationInfo(latitude, longitude) {
                try {
                    const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${latitude}&longitude=${longitude}&localityLanguage=fr`);
                    const data = await response.json();
                    
                    currentLocation = {
                        city: data.city || data.locality || 'Inconnu',
                        country: data.countryName || 'Inconnu',
                        latitude,
                        longitude
                    };
                    
                    cityElement.textContent = currentLocation.city;
                    countryElement.textContent = currentLocation.country;
                } catch (error) {
                    console.error("Erreur de localisation:", error);
                    cityElement.textContent = 'Inconnu';
                    countryElement.textContent = 'Inconnu';
                }
            }

            async function getWeather(latitude, longitude) {
                try {
                    const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true`);
                    const data = await response.json();
                    
                    if (data.current_weather) {
                        const temp = Math.round(data.current_weather.temperature);
                        temperatureElement.textContent = `${temp}°C`;
                    }
                } catch (error) {
                    console.error("Erreur météo:", error);
                    temperatureElement.textContent = '--°C';
                }
            }

            async function getPrayerTimes(latitude, longitude) {
                const date = new Date();
                const day = date.getDate();
                const month = date.getMonth() + 1;
                const year = date.getFullYear();
                
                try {
                    const response = await fetch(`https://api.aladhan.com/v1/timings/${day}-${month}-${year}?latitude=${latitude}&longitude=${longitude}&method=4`);
                    const data = await response.json();
                    
                    if (data.code === 200) {
                        prayerTimes = data.data.timings;
                        renderPrayerTimes();
                        updateNextPrayer();
                    }
                } catch (error) {
                    console.error("Erreur des heures de prière:", error);
                    // Valeurs par défaut en cas d'erreur
                    prayerTimes = {
                        Fajr: '06:00',
                        Dhuhr: '14:15',
                        Asr: '17:00',
                        Maghrib: '19:00',
                        Isha: '20:00'
                    };
                    renderPrayerTimes();
                    updateNextPrayer();
                }
            }

            function renderPrayerTimes() {
                prayerTimesContainer.innerHTML = '';
                
                Object.keys(prayerNames).forEach(prayerKey => {
                    if (prayerTimes[prayerKey]) {
                        const prayer = prayerNames[prayerKey];
                        const prayerTime = formatTime(prayerTimes[prayerKey]);
                        
                        const prayerCard = document.createElement('div');
                        prayerCard.className = 'prayer-card';
                        prayerCard.id = `prayer-${prayerKey.toLowerCase()}`;
                        prayerCard.innerHTML = `
                            <div class="prayer-info">
                                <div class="prayer-icon" style="color: ${prayer.color}">
                                    <i class="fas ${prayer.icon}"></i>
                                </div>
                                <div>
                                    <div class="prayer-name">${prayer.name}</div>
                                    <div class="prayer-remaining" id="${prayerKey.toLowerCase()}-remaining"></div>
                                </div>
                            </div>
                            <div class="prayer-time">
                                <div class="prayer-time-value">${prayerTime}</div>
                            </div>
                        `;
                        
                        prayerTimesContainer.appendChild(prayerCard);
                    }
                });
            }

            function updateNextPrayer() {
                const now = new Date();
                const currentTimeInMinutes = now.getHours() * 60 + now.getMinutes();
                
                const prayerTimesInMinutes = {};
                Object.keys(prayerNames).forEach(prayerKey => {
                    if (prayerTimes[prayerKey]) {
                        const [hours, minutes] = prayerTimes[prayerKey].split(':').map(Number);
                        prayerTimesInMinutes[prayerKey] = hours * 60 + minutes;
                    }
                });
                
                // Trouver la prochaine prière
                let nextPrayerName = null;
                let nextPrayerTime = null;
                
                // Vérifier chaque prière dans l'ordre
                const prayerOrder = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
                for (const prayer of prayerOrder) {
                    if (!prayerTimesInMinutes[prayer]) continue;
                    
                    let prayerTime = prayerTimesInMinutes[prayer];
                    
                    // Si c'est Fajr et qu'on est après Isha, c'est Fajr du lendemain
                    if (prayer === 'Fajr' && currentTimeInMinutes >= prayerTimesInMinutes['Isha']) {
                        prayerTime += 24 * 60;
                    }
                    // Pour les autres prières, si l'heure est passée, c'est le lendemain
                    else if (currentTimeInMinutes > prayerTime) {
                        prayerTime += 24 * 60;
                    }
                    
                    // Si c'est la première prière trouvée ou plus tôt que la précédente
                    if (nextPrayerTime === null || prayerTime < nextPrayerTime) {
                        nextPrayerName = prayer;
                        nextPrayerTime = prayerTime;
                    }
                }
                
                if (nextPrayerName && nextPrayerTime !== null) {
                    nextPrayer = {
                        name: nextPrayerName,
                        time: nextPrayerTime
                    };
                    
                    updateNextPrayerUI();
                    startCountdown();
                    updatePrayersRemainingTime();
                    highlightCurrentPrayer();
                }
            }

            function updateNextPrayerUI() {
                if (!nextPrayer) return;
                
                nextPrayerNameElement.textContent = nextPrayer.name;
                const prayerTime = convertMinutesToTime(nextPrayer.time % (24 * 60));
                nextPrayerTimeElement.textContent = formatTime(prayerTime);
            }

            function startCountdown() {
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                }
                
                updateCountdown();
                countdownInterval = setInterval(updateCountdown, 1000);
            }

            function updateCountdown() {
                if (!nextPrayer) return;
                
                const now = new Date();
                const currentTimeInSeconds = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
                
                let nextPrayerTimeInSeconds = nextPrayer.time * 60;
                if (nextPrayer.time >= 24 * 60) {
                    nextPrayerTimeInSeconds = (nextPrayer.time - 24 * 60) * 60;
                    if (now.getHours() < 24) {
                        nextPrayerTimeInSeconds += 24 * 3600;
                    }
                }
                
                const remainingSeconds = nextPrayerTimeInSeconds - currentTimeInSeconds;
                
                if (remainingSeconds <= 0) {
                    // Recharger les heures de prière
                    if (currentLocation.latitude && currentLocation.longitude) {
                        getPrayerTimes(currentLocation.latitude, currentLocation.longitude);
                    }
                    return;
                }
                
                const hours = Math.floor(remainingSeconds / 3600);
                const minutes = Math.floor((remainingSeconds % 3600) / 60);
                const seconds = remainingSeconds % 60;
                
                countdownElement.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Mettre à jour la barre de progression
                const lastPrayerTime = getLastPrayerTime();
                const timeBetweenPrayers = nextPrayer.time - lastPrayerTime;
                const timeSinceLastPrayer = (now.getHours() * 60 + now.getMinutes()) - lastPrayerTime;
                
                const progressPercentage = (timeSinceLastPrayer / timeBetweenPrayers) * 100;
                progressBarElement.style.width = `${Math.min(100, Math.max(0, progressPercentage))}%`;
            }

            function getLastPrayerTime() {
                if (!nextPrayer) return 0;
                
                const prayerOrder = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
                const currentIndex = prayerOrder.indexOf(nextPrayer.name);
                
                if (currentIndex === 0) {
                    // Si la prochaine est Fajr, la précédente est Isha (veille)
                    const [ishaHours, ishaMinutes] = prayerTimes['Isha'].split(':').map(Number);
                    return ishaHours * 60 + ishaMinutes - 24 * 60;
                } else {
                    const lastPrayerName = prayerOrder[currentIndex - 1];
                    const [lastHours, lastMinutes] = prayerTimes[lastPrayerName].split(':').map(Number);
                    return lastHours * 60 + lastMinutes;
                }
            }

            function updatePrayersRemainingTime() {
                const now = new Date();
                const currentTimeInMinutes = now.getHours() * 60 + now.getMinutes();
                
                Object.keys(prayerNames).forEach(prayerKey => {
                    if (!prayerTimes[prayerKey]) return;
                    
                    const [hours, minutes] = prayerTimes[prayerKey].split(':').map(Number);
                    let prayerTimeInMinutes = hours * 60 + minutes;
                    
                    // Ajuster pour le lendemain si nécessaire
                    if ((prayerKey === 'Fajr' && currentTimeInMinutes >= convertTimeToMinutes(prayerTimes['Isha'])) || 
                        (prayerKey !== 'Fajr' && currentTimeInMinutes > prayerTimeInMinutes)) {
                        prayerTimeInMinutes += 24 * 60;
                    }
                    
                    const remainingMinutes = prayerTimeInMinutes - currentTimeInMinutes;
                    const remainingElement = document.getElementById(`${prayerKey.toLowerCase()}-remaining`);
                    
                    if (remainingElement) {
                        if (remainingMinutes > 0) {
                            const hours = Math.floor(remainingMinutes / 60);
                            const mins = remainingMinutes % 60;
                            remainingElement.textContent = `Dans ${hours}h ${mins}m`;
                        } else {
                            remainingElement.textContent = '';
                        }
                    }
                });
            }

            function highlightCurrentPrayer() {
                // Désactiver toutes les cartes
                document.querySelectorAll('.prayer-card').forEach(card => {
                    card.classList.remove('active');
                });
                
                const now = new Date();
                const currentTimeInMinutes = now.getHours() * 60 + now.getMinutes();
                const prayerTimesInMinutes = {};
                
                Object.keys(prayerNames).forEach(prayerKey => {
                    if (prayerTimes[prayerKey]) {
                        const [hours, minutes] = prayerTimes[prayerKey].split(':').map(Number);
                        prayerTimesInMinutes[prayerKey] = hours * 60 + minutes;
                    }
                });
                
                // Trouver la prière actuelle
                let currentPrayer = null;
                
                if (currentTimeInMinutes >= prayerTimesInMinutes['Isha'] || currentTimeInMinutes < prayerTimesInMinutes['Fajr']) {
                    // Entre Isha et Fajr - pas de prière actuelle
                } 
                else if (currentTimeInMinutes >= prayerTimesInMinutes['Fajr'] && currentTimeInMinutes < prayerTimesInMinutes['Dhuhr']) {
                    currentPrayer = 'Fajr';
                } 
                else if (currentTimeInMinutes >= prayerTimesInMinutes['Dhuhr'] && currentTimeInMinutes < prayerTimesInMinutes['Asr']) {
                    currentPrayer = 'Dhuhr';
                } 
                else if (currentTimeInMinutes >= prayerTimesInMinutes['Asr'] && currentTimeInMinutes < prayerTimesInMinutes['Maghrib']) {
                    currentPrayer = 'Asr';
                } 
                else if (currentTimeInMinutes >= prayerTimesInMinutes['Maghrib'] && currentTimeInMinutes < prayerTimesInMinutes['Isha']) {
                    currentPrayer = 'Maghrib';
                }
                
                if (currentPrayer) {
                    const prayerCard = document.getElementById(`prayer-${currentPrayer.toLowerCase()}`);
                    if (prayerCard) {
                        prayerCard.classList.add('active');
                    }
                }
            }

            async function getHijriDate() {
    const date = new Date();
    const day = date.getDate();
    const month = date.getMonth() + 1;
    const year = date.getFullYear();
    
    try {
        const response = await fetch(`https://api.aladhan.com/v1/gToH/${day}-${month}-${year}`);
        const data = await response.json();
        
        if (data.code === 200) {
            const hijri = data.data.hijri;
            const hijriDateElement = document.getElementById('hijri-date');
            
            // Formatage de la date hijri en français
            const hijriMonthsFr = {
                "Muharram": "Mouharram",
                "Safar": "Safar",
                "Rabi al-Awwal": "Rabi al-Awwal",
                "Rabi al-Thani": "Rabi ath-Thani",
                "Jumada al-Awwal": "Joumada al-Oula",
                "Jumada al-Thani": "Joumada ath-Thani",
                "Rajab": "Rajab",
                "Sha'ban": "Cha'ban",
                "Ramadan": "Ramadan",
                "Shawwal": "Chawwal",
                "Dhu al-Qi'dah": "Dhou al-Qi'dah",
                "Dhu al-Hijjah": "Dhou al-Hijjah"
            };
            
            const monthFr = hijriMonthsFr[hijri.month.en] || hijri.month.en;
            hijriDateElement.textContent = `${hijri.day} ${monthFr} ${hijri.year} AH`;
        }
    } catch (error) {
        console.error("Erreur de date hijri:", error);
        document.getElementById('hijri-date').textContent = '--/--/---- AH';
    }
}

            // Fonctions utilitaires
            function formatTime(timeString) {
                if (!timeString) return '--:--';
                if (/^\d{1,2}:\d{2}$/.test(timeString)) {
                    const [hours, minutes] = timeString.split(':');
                    return `${hours.padStart(2, '0')}:${minutes}`;
                }
                return timeString;
            }

            function convertMinutesToTime(minutes) {
                const hours = Math.floor(minutes / 60) % 24;
                const mins = minutes % 60;
                return `${hours}:${mins.toString().padStart(2, '0')}`;
            }

            function convertTimeToMinutes(timeString) {
                const [hours, minutes] = timeString.split(':').map(Number);
                return hours * 60 + minutes;
            }
        });
    </script>


</body></html>